<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"
        >


    <!--　************************************************************************
    コントローラーテスト用のbean定義ファイル

      使い方
    ・Service層のコンポーネントスキャンの設定に、モック化するサービス用の例外設定をする（118行目〜）
    ・モック化するサービスのBean定義をする（143行目くらい〜）
    ************************************************************************ -->


    <!-- 環境ごとに読み込むプロパティファイルを切り替える -->
    <import resource="core/property.xml"/>

    <!-- DATA SOURCE -->
    <import resource="core/data-source.xml"/>

    <!-- テストコード用のcomponent-scanの設定の読込 -->
    <import resource="core/component-scan.xml"/>

    <context:component-scan base-package="jp.co.biglobe.isp.auth.api"/>
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.voiceoption.testdata"/>


    <!-- AOP設定の読込 -->
    <import resource="classpath:META-INF/core/aop/aop.xml"/>

    <!-- MyBatis設定の読込 -->
    <import resource="classpath:META-INF/core/database/database.xml"/>

    <!-- コントローラ設定の読込 -->
    <import resource="classpath:META-INF/core/controller/controller.xml"/>

    <!-- リクエストスコープの設定の読込 -->
    <import resource="classpath:META-INF/core/scope/scope.xml"/>

    <!-- Framework層設定の読込 -->
    <import resource="classpath:META-INF/core/component-scan.xml"/>


    <bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
        <!-- one of the properties available; the maximum file size in bytes -->
        <property name="maxUploadSize" value="9447424"/>
    </bean>

    <!-- ここからAutowiredを行うためのClassの読み込み。パッケージを追加した場合、ここに追加が必要な場合がある。
    読み込むパッケージが増えてきたら、ファイルを分ける。-->


    <!-- Controller層 -->
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.voiceoption.api"/>
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.biglobedenwa.api"/>

    <!-- DataSource層 -->
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.voiceoption.datasource">
        <context:exclude-filter type="regex"
                                expression="jp.co.biglobe.isp.mobile.voiceoption.datasource.identificationfiles.local.*"/>
        <context:exclude-filter type="regex"
                                expression="jp.co.biglobe.isp.mobile.voiceoption.datasource.identificationfiles.sftp.*"/>
    </context:component-scan>
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.biglobedenwa.datasource"/>

    <context:component-scan base-package="jp.co.biglobe.isp.mobile.ltethreeg.datasource"/>
    <context:component-scan base-package="jp.co.biglobe.isp.auth.datasource"/>
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.biglobemember.datasource"/>


    <!-- Service層 -->
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.voiceoption.service">
        <!--　ここにMock化対象のサービスクラスのスキャン除外設定を記述　-->
        <context:exclude-filter type="regex"
                                expression="jp.co.biglobe.isp.mobile.voiceoption.service.mnpout.MnpOutConfirmReferService"/>
    </context:component-scan>
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.biglobedenwa.service"/>

    <context:component-scan base-package="jp.co.biglobe.isp.auth.service"/>

    <!-- 監視 -->
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.monitoring.api"/>

    <!-- extension -->
    <context:component-scan base-package="jp.co.biglobe.isp.mobile.extension"/>

    <beans profile="local,development,testing">
        <context:component-scan base-package="jp.co.biglobe.isp.mobile.voiceoption.testdata"/>
    </beans>
    <beans profile="development,staging,testing,production">
        <bean id="identificationFilesRepository"
              class="jp.co.biglobe.isp.mobile.voiceoption.datasource.identificationfiles.sftp.IdentificationFilesRepositorySftp"/>
    </beans>
    <beans profile="local">
        <bean id="identificationFilesRepository"
              class="jp.co.biglobe.isp.mobile.voiceoption.datasource.identificationfiles.local.IdentificationFilesRepositoryLocal"/>
    </beans>

    <!--　ここにMock化対象のサービスクラスのbean定義を記述　-->
    <beans>
        <bean id="mnpOutConfirmReferServiceMock" class="org.mockito.Mockito" factory-method="mock">
            <constructor-arg
                    value="jp.co.biglobe.isp.mobile.voiceoption.service.mnpout.MnpOutConfirmReferService"/>
        </bean>
    </beans>


</beans>
